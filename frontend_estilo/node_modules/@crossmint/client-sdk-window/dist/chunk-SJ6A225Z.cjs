"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunk4TY23RRKcjs = require('./chunk-4TY23RRK.cjs');var _chunkOG5ZZ7ACcjs = require('./chunk-OG5ZZ7AC.cjs');var _chunkNIHEG35Icjs = require('./chunk-NIHEG35I.cjs');var _zod = require('zod');var c=class p extends _chunk4TY23RRKcjs.a{constructor(t,e){let E=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},e==null?void 0:e.incomingEvents),s.fromParent),h=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},e==null?void 0:e.outgoingEvents),s.fromChild);super(t,E,h);this.isConnected=!1;this.handshakeOptions=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},d),e==null?void 0:e.handshakeOptions)}handshakeWithParent(){return _chunkNIHEG35Icjs.e.call(void 0, this,null,function*(){if(this.isConnected){console.log("[client] Already connected to parent");return}let{requestVerificationId:t}=yield this._onAction({event:"handshakeRequest",callback:e=>e,responseEvent:"handshakeResponse",options:{timeoutMs:this.handshakeOptions.timeoutMs}});yield this._onAction({event:"handshakeComplete",options:{timeoutMs:this.handshakeOptions.timeoutMs,condition:e=>e.requestVerificationId===t}}),this.isConnected=!0})}_onAction(t){return _chunkNIHEG35Icjs.e.call(void 0, this,null,function*(){return yield _chunkNIHEG35Icjs.d.call(void 0, p.prototype,this,"onAction").call(this,_chunkNIHEG35Icjs.b.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},t),{options:t.options}))})}};var d={timeoutMs:1e4,intervalMs:100},s= exports.c ={fromChild:{handshakeResponse:_zod.z.object({requestVerificationId:_zod.z.string()})},fromParent:{handshakeRequest:_zod.z.object({requestVerificationId:_zod.z.string()}),handshakeComplete:_zod.z.object({requestVerificationId:_zod.z.string()})}};var k=class extends _chunk4TY23RRKcjs.a{constructor(t,e){let E=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},e==null?void 0:e.incomingEvents),s.fromChild),h=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},e==null?void 0:e.outgoingEvents),s.fromParent);super(t,E,h);this.isConnected=!1;this.handshakeOptions=_chunkNIHEG35Icjs.a.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},d),e==null?void 0:e.handshakeOptions)}handshakeWithChild(){return _chunkNIHEG35Icjs.e.call(void 0, this,null,function*(){if(this.isConnected){console.log("[server] Already connected to child");return}let t=_chunkOG5ZZ7ACcjs.a.call(void 0, );yield this._sendAction({event:"handshakeRequest",data:{requestVerificationId:t},responseEvent:"handshakeResponse",options:{timeoutMs:this.handshakeOptions.timeoutMs,intervalMs:this.handshakeOptions.intervalMs,condition:e=>e.requestVerificationId===t}}),this._send("handshakeComplete",{requestVerificationId:t}),this.isConnected=!0})}_send(t,e){return super.send(t,e)}_sendAction(t){return super.sendAction(_chunkNIHEG35Icjs.b.call(void 0, _chunkNIHEG35Icjs.a.call(void 0, {},t),{options:t.options}))}};exports.a = k; exports.b = d; exports.c = s; exports.d = c;
